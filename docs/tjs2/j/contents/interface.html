<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html  xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- generated by to_html.pl from interface.xml -->
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<title>iTJSDispatch2 Interface</title>
	<meta name="author" content="W.Dee" />
	<meta http-equiv="Content-Style-Type" content="text/css" />
	<meta http-equiv="Content-Script-Type" content="text/javascript" />
	<link href="browser.css" type="text/css" rel="stylesheet" title="Standard style for Kirikiri-related references" />
	<link href="mailto:dee@kikyou.info" rev="Made" />
	<link href="index.html" target="_top" rel="Start" title="Top Page" />
</head>
<body>
<h1><a id="id220" name="id220">About iTJSDispatch2</a>
</h1><div class="para"><div>
　iTJSDispatch2 is an abstract base class that provides an interface for "objects" in TJS2.<br />
　TJS2 "objects" include function objects, classes, property objects, arrays (dictionary arrays), etc.<br />
　Most operations on TJS2 can be performed through this interface.<br />
<br />
　The following explanation is provided from the perspective of using this interface.<br />
</div></div>



<h1><a id="id221" name="id221">Call by Ordinal</a>
</h1><div class="para"><div>
<br />
　Some methods of iTJSDispatch2 have names ending in "ByNum". These are used for calls by ordinal (index); for example, calling FuncCall with the member name "23" is equivalent to calling FuncCallByNum with the ordinal 23.<br />
　This is convenient when accessing array objects.<br />
<br />
　Methods ending in ByNum do not have the membername and hint arguments of the eponymous methods without ByNum; instead, they have a tjs_int num argument. Specify the ordinal in the num argument.<br />
<br />
　In the following, detailed explanations for methods that perform calls by ordinal will be omitted (refer to the description of the namesake method without the ByNum suffix).<br />
</div></div>








<h1><a id="id222" name="id222">AddRef</a>
</h1><div class="para"><div>
tjs_uint iTJSDispatch2::AddRef(void)<br />
<br />
　Increments the object's reference counter.<br />
　Each object in TJS2 is managed by a reference counter.<br />
　The return value is the value of the reference counter after the increment, but relying on this value is not recommended.<br />
</div></div>








<h1><a id="id223" name="id223">Release</a>
</h1><div class="para"><div>
tjs_uint iTJSDispatch2::Release(void)<br />
<br />
　Decrements the object's reference counter.<br />
　The return value is the value of the reference counter after the decrement; a return of 0 indicates that the object has been released. However, relying on this value is not recommended.<br />
</div></div>












<h1><a id="id224" name="id224">FuncCall</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::FuncCall(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Executes a function call.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　The name of the member to operate on.<br />
　If NULL, the operation is performed on the object itself. In this case, the object must have function capabilities.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a "<a id="id225" name="id225" class="targanchor"><dfn>hint</dfn></a>". It may be NULL.<br />
　Hints are used to speed up subsequent searches for the same member name. If a pointer to a tjs_uint32 type variable is specified for hint, a numerical value serving as a hint will be written there. From the second time onwards, the member is searched with reference to that numerical value. Since it is only a reference, the initial value of the hint can be anything (0 is recommended). Also, due to this mechanism, it is more efficient if the hint and its corresponding member name have a one-to-one correspondence (the tTJSString type has a mechanism for this hint).<br />
　Some objects may not have a mechanism to utilize hints.</dd>

<dt>tTJSVariant *result</dt>
<dd>　Specifies a pointer to a tTJSVariant type to store the result of the function call.<br />
　If the result is not needed, NULL may be specified.</dd>

<dt>tjs_int numparams</dt>
<dd>　Specifies the number of arguments to pass to the function.</dd>

<dt>tTJSVariant **param</dt>
<dd>　Passes an array of pointers to the arguments to be passed to the function. If there are no arguments, it can be NULL.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which the function is executed.</dd></dl></div></div>




<h1><a id="id226" name="id226">FuncCallByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::FuncCall(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Executes a function call by ordinal.<br />
</div></div>



<h1><a id="id227" name="id227">PropGet</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropGet(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Retrieves the value of a property or member variable.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　The name of the member to operate on.<br />
<br />
　If NULL, the operation is performed on the object itself. In this case, the object must have property retrieval capabilities.<br />
　An object that succeeds even if this argument is NULL is considered a property object. Normally, when such a property object becomes a member of another object, the result of performing PropGet on that property object is used instead of the property object itself. This behavior can be bypassed by specifying TJS_IGNOREPROP in the call flags.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>tTJSVariant *result</dt>
<dd>　Specifies a pointer to a tTJSVariant type to store the result. NULL is not allowed.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.</dd></dl></div></div>


<h1><a id="id228" name="id228">PropGetByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropGetByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Retrieves the value of a property or member variable by ordinal.<br />
</div></div>






<h1><a id="id229" name="id229">PropSet</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropSet(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Sets the value of a property or member variable.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　The name of the member to operate on.<br />
<br />
　If NULL, the operation is performed on the object itself. In this case, the object must have property setting capabilities.<br />
　An object that succeeds even if this argument is NULL is considered a property object. Normally, when such a property object becomes a member of another object, PropSet is called on that property object instead of the property object itself. This behavior can be bypassed by specifying TJS_IGNOREPROP in the call flags.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>const tTJSVariant *param</dt>
<dd>　Specifies a pointer to a tTJSVariant type variable representing the value to set. NULL is not allowed.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.</dd></dl></div></div>

<h1><a id="id230" name="id230">PropSetByVS</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropSetByVS(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariantString *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Sets the value of a property or member variable. The difference from PropSet is that the member name is referenced via tTJSVariantString. This is used internally. Since tTJSVariantString has a mechanism where multiple string objects share the same string memory area, setting properties through this method (creating members within an object) can prevent an increase in memory usage for string memory areas used for member names.<br />
　If you do not implement this method, return TJS_E_NOTIMPL. PropSet will be used instead. Also, if calling this method returns TJS_E_NOTIMPL, implement the caller to use PropSet instead.<br />
<br />
</div></div>





<h1><a id="id231" name="id231">PropSetByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::PropSetByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Sets the value of a property or member variable by ordinal.<br />
</div></div>






<h1><a id="id232" name="id232">GetCount</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::GetCount(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Returns the number of members held by the object.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_int *result</dt>
<dd>　Specifies a pointer to a variable to store the result. NULL is not allowed.</dd>

<dt>const tjs_char * membername</dt>
<dd>　Specifies the name of the target member.<br />
　If NULL, the number of members held by this object itself is returned.<br />
　If a member name is specified, and if that member is an object, the number of members held by that object is returned. If the specified member is not an object type, it fails.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.<br />
　This argument usually has no meaning (it is ignored).</dd></dl></div></div>



<h1><a id="id233" name="id233">GetCountByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::GetCount(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　The ordinal version of GetCount.<br />
</div></div>


<h1><a id="id234" name="id234">DeleteMember</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::DeleteMember(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Deletes a member.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　Specifies the name of the target member. NULL is not allowed.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.<br />
　This argument usually has no meaning (it is ignored).</dd></dl></div></div>





<h1><a id="id235" name="id235">DeleteMemberByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::DeleteMemberByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Deletes a member by ordinal.<br />
</div></div>


<h1><a id="id236" name="id236">EnumMembers</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::EnumMembers(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariantClosure *callback,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Enumerates the members within the object.<br />
　A callback function can be specified in callback, but in the current version, operation is not guaranteed if members of this object are created or deleted within the callback function.<br />
<br />
　The arguments are as follows:<br />
　<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags. For call flags, specify the bitwise OR of the following flags or 0 (zero).<br />
<dl>
<dt>TJS_IGNOREPROP</dt>
<dd>　Disables property access. When enumerating members and retrieving values, if this flag is specified and a member is a property, the property object itself is obtained. If this flag is not specified, the value obtained through the property object is returned.<br />
</dd>
<dt>TJS_ENUM_NO_VALUE</dt>
<dd>　Does not retrieve values. If this flag is specified, the number of arguments passed to the callback function will be two. If not specified, it will be three.<br />
</dd></dl></dd>
<dt>tTJSVariantClosure *callback</dt>
<dd>　Specifies the callback function.<br />
　This callback function has callback-&gt;FuncCall invoked once for each member.<br />
　The function is passed two (if TJS_ENUM_NO_VALUE is specified) or three (if TJS_ENUM_NO_VALUE is not specified) arguments.<br />
<ul><li>The first argument is a string type, representing the member name.</li><li>The second argument is an integer type, representing the member's flags. A combination of TJS_HIDDENMEMBER or TJS_STATICMEMBER bitwise OR, or 0 is specified.</li><li>The third argument exists only if TJS_ENUM_NO_VALUE is not specified, representing the member's value.</li></ul></dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.<br />
　If the TJS_IGNOREPROP flag is not specified, this argument becomes the default context in which the property object is executed.<br />
</dd></dl>


</div></div>







<h1><a id="id237" name="id237">Invalidate</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::Invalidate(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Performs invalidation.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　Specifies the name of the target member.<br />
　If NULL, the object itself is invalidated.<br />
　If a member name is specified, and if that member is an object, that object is invalidated. If the specified member is not an object type, it fails.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.<br />
　This argument usually has no meaning (it is ignored).</dd></dl></div></div>


<h1><a id="id238" name="id238">InvalidateByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::InvalidateByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
Performs invalidation by ordinal.<br />
</div></div>




<h1><a id="id239" name="id239">IsValid</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsValid(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Checks if the object is valid.<br />
　Returns TJS_S_TRUE if valid, and TJS_S_FALSE if invalid.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　Specifies the name of the target member.<br />
　If NULL, the validity of this object itself can be checked.<br />
　If a member name is specified, and if that member is an object, the validity of that object can be checked. If the specified member is not an object type, it fails.
</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) in which this method is executed.<br />
　This argument usually has no meaning (it is ignored).</dd></dl></div></div>






<h1><a id="id240" name="id240">IsValidByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsValidByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Checks if an object is valid by ordinal.<br />
</div></div>





<h1><a id="id241" name="id241">CreateNew</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::CreateNew(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 **result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Creates a new object.<br />
　This method is similar to the FuncCall method, allowing arguments to be passed for the purpose of creating a new object.<br />
　The so-called "class objects" that serve as blueprints for objects must implement this method.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　The name of the member to operate on.<br />
　If NULL, the operation is performed on the object itself. In this case, the object must have the capability to create new objects.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>iTJSDispatch2 **result</dt>
<dd>　Specifies a pointer to an iTJSDispatch * type to store the newly created object. NULL is not allowed.</dd>

<dt>tjs_int numparams</dt>
<dd>　Specifies the number of arguments to pass when creating the new object.</dd>

<dt>tTJSVariant **param</dt>
<dd>　Passes an array of pointers to the arguments to be passed when creating the new object. If there are no arguments, it can be NULL.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) executed when the object is newly created.</dd></dl></div></div>




<h1><a id="id242" name="id242">CreateNewByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::CreateNew(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 **result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int numparams,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant **param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Creates a new object by ordinal.<br />
</div></div>







<h1><a id="id243" name="id243">IsInstanceOf</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsInstanceOf(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * classname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Checks whether an object is an instance of a specific class.<br />
　The class name is passed as a string in the classname argument.<br />
　Referenced by the TJS2 instanceof operator.<br />
　If successful, TJS_S_TRUE is returned if it is an instance of the specified class, and TJS_S_FALSE otherwise.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags (see below).</dd>

<dt>const tjs_char * membername</dt>
<dd>　The name of the member to operate on.<br />
　If NULL, the operation is performed on the object itself. In this case, the object must have the capability to create new objects.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>const tjs_char *classname</dt>
<dd>　Specifies the class name as a string.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context (this object) executed when the object is newly created.</dd></dl></div></div>



<h1><a id="id244" name="id244">IsInstanceOfByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::IsInstanceOfByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char * classname,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Checks whether an object is an instance of a specific class by ordinal.<br />
</div></div>



<h1><a id="id245" name="id245">Operation</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::Operation(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tjs_char *membername,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 *hint,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Performs an operation on a member. The type of operation is specified by flag.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flag. In addition to the normal call flags below, one of the following flags must be added via bitwise OR to specify the operation type.<br />
<br />
　In this explanation, v represents the value of the member, and p represents the parameter passed in the param argument.<br />
<br />
<dl>
<dt>TJS_OP_BAND</dt>
<dd>Bitwise AND operation<br />
v &amp;= p</dd>

<dt>TJS_OP_BOR</dt>
<dd>Bitwise OR operation<br />
v |= p</dd>

<dt>TJS_OP_BXOR</dt>
<dd>Bitwise XOR operation<br />
v ^= p</dd>

<dt>TJS_OP_SUB</dt>
<dd>Subtraction<br />
v -= p</dd>

<dt>TJS_OP_ADD</dt>
<dd>Addition<br />
v += p</dd>

<dt>TJS_OP_MOD</dt>
<dd>Modulo<br />
v %= p</dd>

<dt>TJS_OP_DIV</dt>
<dd>Real division<br />
v /= p</dd>

<dt>TJS_OP_IDIV</dt>
<dd>Integer division<br />
v \= p</dd>

<dt>TJS_OP_MUL</dt>
<dd>Multiplication<br />
v *= p</dd>

<dt>TJS_OP_LOR</dt>
<dd>Logical OR<br />
v = v || p</dd>

<dt>TJS_OP_LAND</dt>
<dd>Logical AND<br />
v = v &amp;&amp; p</dd>

<dt>TJS_OP_SAR</dt>
<dd>Arithmetic right shift<br />
v &gt;&gt;= p</dd>

<dt>TJS_OP_SAL</dt>
<dd>Arithmetic left shift<br />
v &lt;&lt;= p</dd>

<dt>TJS_OP_SR</dt>
<dd>Logical right shift<br />
v &gt;&gt;&gt;= p</dd>

<dt>TJS_OP_INC</dt>
<dd>Increment<br />
v++<br />
The param argument is ignored</dd>

<dt>TJS_OP_DEC</dt>
<dd>Decrement<br />
v--<br />
The param argument is ignored</dd></dl>
</dd>

<dt>const tjs_char * membername</dt>
<dd>　The name of the member to operate on. NULL is not allowed.</dd>

<dt>tjs_uint32 *hint</dt>
<dd>　Specifies the memory area for a variable to store a hint. It may be NULL.<br />
　For a description of hints, refer to the description of FuncCall.</dd>

<dt>tTJSVariant *result</dt>
<dd>　Specifies a pointer to a tTJSVariant type variable to store the result of the operation. It may be NULL.</dd>

<dt>tTJSVariant *param</dt>
<dd>　Specifies the parameter for the operation. If TJS_OP_INC or TJS_OP_DEC is specified as the operation type, it can be NULL.</dd>

<dt>iTJSDispatch2 *objthis</dt>
<dd>　Specifies the context in which the operation is performed, but is usually ignored.</dd></dl></div></div>




<h1><a id="id246" name="id246">OperationByNum</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::OperationByNum(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *result,<br />
&nbsp;&nbsp;&nbsp;&nbsp;const tTJSVariant *param,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSDispatch2 *objthis<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Performs an operation on a member using an ordinal.<br />
</div></div>



<h1><a id="id247" name="id247">NativeInstanceSupport</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::NativeInstanceSupport(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_int32 classid,<br />
&nbsp;&nbsp;&nbsp;&nbsp;iTJSNativeInstance **pointer<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　Associates a native code instance with an object or retrieves a native code instance from an object.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Specifies the call flag.<br />
　One of the following values must be specified:<br />
<br />
<dl>
<dt><a id="id248" name="id248" class="targanchor"><dfn>TJS_NIS_REGISTER</dfn></a></dt>
<dd>　Registers the native code instance indicated by *pointer. Uses classid to identify the native code class.</dd>


<dt><a id="id249" name="id249" class="targanchor"><dfn>TJS_NIS_GETINSTANCE</dfn></a></dt>
<dd>　Writes the native code instance having the Class ID specified by classid into *pointer.</dd></dl></dd>


<dt>tjs_int32 classid</dt>
<dd>　Specifies the native code Class ID.<br />
　TJSRegisterNativeClass, TJSFindNativeClassID, and TJSFindNativeClassName can be used to manage native code Class IDs, but usually, these processes are handled automatically by the support code groups for writing native code (described in tjsNative.cpp/tjsNative.h).</dd>


<dt>iTJSNativeInstance **pointer</dt>
<dd>　Specifies a pointer to a variable of type iTJSNativeInstance * for passing or receiving the native code instance.</dd></dl></div></div>


<h1><a id="id250" name="id250">ClassInstanceInfo</a>
</h1><div class="para"><div>
tjs_error iTJSDispatch2::ClassInstanceInfo(<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint32 flag,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tjs_uint num,<br />
&nbsp;&nbsp;&nbsp;&nbsp;tTJSVariant *value<br />
&nbsp;&nbsp;&nbsp;&nbsp;)<br />
<br />
　A method used by the IsInstanceOf method to manipulate class instance information.<br />
　You can add class names to identify which class an object is an instance of, or enumerate classes to determine which class an object is an instance of.<br />
<br />
　The arguments are as follows:<br />
<br />
<dl>
<dt>tjs_uint32 flag</dt>
<dd>　Call flags. Specify one of the following flags:<br />
<br />
<dl>
<dt><a id="id251" name="id251" class="targanchor"><dfn>TJS_CII_ADD</dfn></a></dt>
<dd>　Adds instance information.<br />
　Pass a pointer to a tTJSVariant variable containing the class name (string) to value.<br />
　The num argument is ignored.</dd>

<dt><a id="id252" name="id252" class="targanchor"><dfn>TJS_CII_GET</dfn></a></dt>
<dd>　Retrieves instance information.<br />
　Specify a 0-based integer in the num argument. If num is specified beyond the number of set instance information entries, TJS_E_FAIL is returned.<br />
　Pass a pointer to a tTJSVariant variable to receive the class name to value.</dd></dl></dd>


<dt>tjs_uint num</dt>
<dd>　Specifies the ordinal when flag is set to TJS_CII_GET.</dd>


<dt>tTJSVariant *value</dt>
<dd>　When flag is set to TJS_CII_ADD, pass a pointer to a tTJSVariant variable containing the class name.<br />
　When flag is set to TJS_CII_GET, pass a pointer to a tTJSVariant variable to receive the class name.</dd></dl>
</div></div>


<h1><a id="id253" name="id253">Call Flags</a>
</h1><div class="para"><div>

　Call flags.<br />
　A combination of the following values using bitwise OR can be specified.<br />
<br />
<dl>
<dt>TJS_MEMBERENSURE</dt>
<dd>　If the specified member name is not found, it is forcibly created. Valid as a call flag for PropSet.</dd>

<dt>TJS_MEMBERMUSTEXIST</dt>
<dd>　If the specified member name is not found, an error is returned. This is effective for objects like Dictionary or Array that return void by default when a member is not found (for objects that are not like that, it defaults to an error if the member is not found).</dd>




<dt>TJS_IGNOREPROP</dt>
<dd>　Bypasses property operations.<br />
　TJS2 objects normally check if a specified member is an object, and if PropSet or PropGet succeeds on that object (if it's a property object), the result of PropSet or PropGet on that member is used instead of the member itself.<br />
　By specifying this flag, such processing is bypassed; thus, even if the specified member is a property object, the operation is performed on the property object itself.</dd>

<dt>TJS_HIDDENMEMBER</dt>
<dd>　Creating a member with this flag makes the member invisible. This may not be supported by some objects.</dd>
<dt>TJS_STATICMEMBER</dt>
<dd>　Creating a member with this flag makes the member static (independent of the execution context). This may not be supported by some objects.</dd>
</dl></div></div>

<h1><a id="id254" name="id254">tjs_error</a>
</h1><div class="para"><div>
　tjs_error is the error type returned by each method of iTJSDispatch2 (excluding AddRef and Release).<br />
　It takes the following values. Also, for values not listed here, if the value is negative, it must be regarded as an error. To determine this, the TJS_SUCCEEDED and TJS_FAILED macros can be used.<br />
<br />
<dl>
<dt><a id="id255" name="id255" class="targanchor"><dfn>TJS_E_MEMBERNOTFOUND</dfn></a></dt>
<dd>　The specified member was not found.</dd>


<dt><a id="id256" name="id256" class="targanchor"><dfn>TJS_E_NOTIMPL</dfn></a></dt>
<dd>　The feature being called is not implemented.</dd>


<dt><a id="id257" name="id257" class="targanchor"><dfn>TJS_E_INVALIDPARAM</dfn></a></dt>
<dd>　Invalid argument.</dd>


<dt><a id="id258" name="id258" class="targanchor"><dfn>TJS_E_BADPARAMCOUNT</dfn></a></dt>
<dd>　The number of arguments is invalid.</dd>


<dt><a id="id259" name="id259" class="targanchor"><dfn>TJS_E_INVALIDTYPE</dfn></a></dt>
<dd>　Not a function, or the property type is different.<br />
　This value is returned when trying to call something that is not a function, or when treating something that is not a property as a property.</dd>


<dt><a id="id260" name="id260" class="targanchor"><dfn>TJS_E_INVALIDOBJECT</dfn></a></dt>
<dd>　The object has already been invalidated.</dd>


<dt><a id="id261" name="id261" class="targanchor"><dfn>TJS_E_ACCESSDENYED</dfn></a></dt>
<dd>　Attempted an operation that cannot be performed on a read-only or write-only property.</dd>


<dt><a id="id262" name="id262" class="targanchor"><dfn>TJS_E_NATIVECLASSCRASH</dfn></a></dt>
<dd>　The execution context is different.<br />
　This value is returned when trying to execute a method implemented in native code in a context that the native code cannot handle (such as on an object of a different class).</dd>


<dt><a id="id263" name="id263" class="targanchor"><dfn>TJS_S_TRUE</dfn></a></dt>
<dd>　Not an error, but indicates that the result is "true".</dd>


<dt><a id="id264" name="id264" class="targanchor"><dfn>TJS_S_FALSE</dfn></a></dt>
<dd>　Not an error, but indicates that the result is "false".</dd>


<dt><a id="id265" name="id265" class="targanchor"><dfn>TJS_S_OK</dfn></a></dt>
<dd>　Usually, this value is returned when no error occurred.</dd>


<dt><a id="id266" name="id266" class="targanchor"><dfn>TJS_E_FAIL</dfn></a></dt>
<dd>　This value is returned if an undefined error occurs.</dd>


<dt><a id="id267" name="id267" class="targanchor"><dfn>TJS_FAILED</dfn></a>(x)</dt>
<dd>　A macro that is true if x is an error value.</dd>

<dt><a id="id268" name="id268" class="targanchor"><dfn>TJS_SUCCEEDED</dfn></a>(x)</dt>
<dd>　A macro that is true if x is not an error value.</dd></dl><br />

<br />
　Error definitions and related macros are described in tjsErrorDef.h.<br />
　Also, runtime exceptions (in C++) may be thrown instead of errors. Regarding programming, runtime exceptions must be sufficiently considered.<br />
</div></div>

	<script type="text/javascript" charset="UTF-8" src="documentid.js" ></script>
	<script type="text/javascript" charset="UTF-8" src="postcontent.js" ></script>
</body>
</html>